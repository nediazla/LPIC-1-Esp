# 1. ARQUITECTURA DEL SISTEMA

(Objetivos LPIC-1 101-500)

# 1.1 Selección y configuración del hardware

Linux detecta hardware mediante:

- **El kernel**: contiene la mayoría de los drivers modernos.
    
- **Módulos kernel** (`.ko`): drivers que se cargan según necesidad.
    
- **udev**: crea y gestiona dispositivos en `/dev`.
    
- **sysfs** y **procfs**: exponen información del hardware y del kernel.
    

Herramientas fundamentales en Ubuntu:

### Identificar hardware PCI (tarjetas de red, controladoras, GPU)

```
lspci
lspci -v
lspci -nn
```

### Identificar hardware USB

```
lsusb 
lsusb -v
```

### Ver discos, particiones y LVM

```
lsblk -f 
blkid 
fdisk -l
```

### Información del CPU

```
lscpu 
cat /proc/cpuinfo
```

### Información del firmware (BIOS/UEFI)

`sudo dmidecode`

### Cargar y descargar módulos del kernel

```
lsmod               # Módulos cargados
modprobe nombre     # Cargar módulo
modprobe -r nombre  # Descargar módulo
```

### Identificar problemas de hardware

Los mensajes del kernel se revisan con:

```
dmesg | less
dmesg | grep error
journalctl -k
```

### Compatibilidad hardware en Linux

Puntos relevantes para el examen:

- Revisar soporte RAID, NICs, GPUs, WiFi (chipset).
    
- Verificar soporte de virtualización VT-x/AMD-V:
    
```
lscpu | grep Virtualization
egrep -c '(vmx|svm)' /proc/cpuinfo
```

- Ficheros de configuración persistente de módulos:
    
    `/etc/modprobe.d/*.conf`
    

–––––––––––––––––––––––––––

# 1.2 Arranque del sistema (Boot Process)

Ubuntu utiliza **GRUB2 + systemd**.

El proceso completo de arranque es:

## 1. BIOS/UEFI

- Inicializa CPU, RAM, discos.
    
- Busca el bootloader en MBR (BIOS) o en la partición EFI (UEFI).
    
- En UEFI, el archivo clave suele ser:
    
    `/boot/efi/EFI/ubuntu/grubx64.efi`
    

## 2. Gestor de arranque: GRUB2

Tareas:

- Presenta menú de arranque.
    
- Carga el kernel (`vmlinuz`) y el initramfs (`initrd.img`).
    
- Permite editar parámetros del kernel.
    

Comandos:

```
grub-install /dev/sda    # reinstalar GRUB
update-grub              # regenerar menú
```

Archivos importantes:

```
/boot/grub/grub.cfg
/etc/default/grub
```

## 3. Kernel

Una vez cargado:

- Detecta hardware inicial.
    
- Monta el filesystem raíz (root filesystem).
    
- Lanza el proceso PID 1.
    

Parámetros del kernel se añaden en:

`GRUB_CMDLINE_LINUX="quiet splash"`

## 4. Initramfs

Es una mini-imagen con drivers necesarios antes de montar root.

Regenerarlo:

`update-initramfs -u`

## 5. PID 1 – systemd

systemd arranca:

- Servicios
    
- Dependencias
    
- Objetivos (targets)
    
- Redes
    
- TTYs
    

Ver el orden de arranque:

```
systemd-analyze
systemd-analyze blame
systemd-analyze critical-chain
```

Ver logs del arranque actual:

`journalctl -b`

–––––––––––––––––––––––––––

# 1.3 Niveles de ejecución (runlevels), objetivos (targets), apagado y reinicio

LPIC-1 exige dominar tanto runlevels antiguos como systemd moderno.

## Equivalencia Runlevels → systemd targets

|Runlevel|Descripción|systemd target|
|---|---|---|
|0|Apagar|poweroff.target|
|1|Rescate (modo monousuario)|rescue.target|
|2|Multiusuario sin red (varía según distro)|multi-user.target|
|3|Multiusuario con red, sin GUI|multi-user.target|
|5|Multiusuario con GUI|graphical.target|
|6|Reiniciar|reboot.target|

Ubuntu en servidor usa normalmente **multi-user.target**.

## Ver objetivo por defecto

`systemctl get-default`

## Establecer objetivo por defecto

```
sudo systemctl set-default multi-user.target
sudo systemctl set-default graphical.target
```

## Cambiar al instante a otro objetivo (aislar)

```
sudo systemctl isolate rescue.target
sudo systemctl isolate multi-user.target
```

## Apagar o reiniciar

```
systemctl poweroff
systemctl reboot
shutdown -h now
shutdown -r now
shutdown -h +5   # apagar en 5 minutos
```

## Servicio de emergencia

Modo con root sin contraseña:

`systemctl emergency`

## Ver dependencias de un target

`systemctl list-dependencies multi-user.target`

## Ver servicios que fallaron al arrancar

`systemctl --failed`
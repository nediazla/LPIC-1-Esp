# 3. Tareas Administrativas

## 3.1 Gestión de cuentas de usuarios y grupos y archivos relacionados

### Crear usuarios
```
useradd usuario
useradd -m usuario        # crea /home/usuario
useradd -s /bin/bash usuario
passwd usuario
```

Modificar usuario:
```
usermod -s /bin/zsh usuario
usermod -c "comentario" usuario
usermod -aG sudo usuario
usermod -d /nuevo/home usuario
```

Eliminar usuario:
```
userdel usuario
userdel -r usuario      # elimina /home
```

### Crear y gestionar grupos
```
groupadd grupo
groupmod -n nuevo grupo
groupdel grupo
```

Añadir usuario a grupo:
```
usermod -aG grupo usuario
```

Ver grupos:
```
groups usuario
getent group
```

### Archivos importantes del sistema

Información de usuarios:
```
/etc/passwd
```
Formato:
```
usuario:x:UID:GID:comentario:/home/dir:/bin/bash
```

Contraseñas encriptadas:
```
/etc/shadow
```

Grupos:
```
/etc/group
```

Contraseñas de grupos:
```
/etc/gshadow
```

### Gestionar contraseñas y expiración

Cambiar contraseña:
```
passwd usuario
```

Forzar cambio al próximo login:
```
passwd -e usuario
```

Configurar expiración:
```
chage -l usuario
chage -E 2025-12-31 usuario
chage -M 90 usuario
chage -m 5 usuario
chage -W 7 usuario
```

### Crear estructura de skeleton

El contenido de `/etc/skel` se copia a nuevos usuarios:
```
ls /etc/skel
```

Para agregar archivos por defecto:
```
cp archivo /etc/skel/
```

---

## 3.2 Automatización de tareas (cron y at)

### CRON (tareas periódicas)

Editar tareas del usuario:
```
crontab -e
```

Ver tareas:
```
crontab -l
```

Eliminar tareas:
```
crontab -r
```

Formato:
```
* * * * * comando
│ │ │ │ └─ día de la semana (0-7)
│ │ │ └─── mes (1-12)
│ │ └───── día del mes (1-31)
│ └─────── hora (0-23)
└───────── minuto (0-59)
```

Ejemplos:
```
0 2 * * * /usr/local/bin/backup.sh
*/5 * * * * /usr/bin/echo "activo"
15 14 * * 1 systemctl restart apache2
```

### Tareas de sistema en /etc/cron.*
```
/etc/cron.daily
/etc/cron.hourly
/etc/cron.weekly
/etc/cron.monthly
```

### AT (tareas únicas programadas)

Instalar:
```
apt install at
systemctl enable --now atd
```

Programar tarea:
```
echo "systemctl restart ssh" | at now + 10 minutes
```

Ver tareas pendientes:
```
atq
```

Eliminar:
```
atrm ID
```

Ejemplos:
```
at 23:00
at tomorrow
at 5pm Friday
```

---

## 3.3 Localización e internacionalización (i18n)

Ver configuración local:
```
locale
```

Generar idiomas disponibles:
```
locale -a
```

Configurar idioma del sistema:
```
dpkg-reconfigure locales
```

Seleccionar es_ES.UTF-8:
```
es_ES.UTF-8 UTF-8
```

Configurar manualmente `/etc/default/locale`:
```
LANG="es_ES.UTF-8"
LC_TIME="es_ES.UTF-8"
LC_NUMERIC="es_ES.UTF-8"
```

Aplicar configuración:
```
export LANG=es_ES.UTF-8
```

### Configurar zona horaria del sistema

Ver zona actual:
```
timedatectl
```

Listar zonas:
```
timedatectl list-timezones
```

Cambiar zona:
```
timedatectl set-timezone Europe/Madrid
```

### Configuración de teclado en consola (TTY)
```
dpkg-reconfigure keyboard-configuration
```

Configurar la distribución:
- es
- Latin American
- etc.

### Configuración de teclado en X11 y GUI
```
setxkbmap es
```

Persistente en:
```
/etc/default/keyboard
```

Contenido típico:
```
XKBLAYOUT="es"
```

### Variables LC_*
Controlan partes específicas de la localización:
```
LC_CTYPE      # clasificación de caracteres
LC_TIME       # formato de hora
LC_NUMERIC    # decimales y números
LC_MONETARY   # moneda
LC_PAPER      # tamaño de papel
LC_MESSAGES   # idioma de mensajes
```

Ejemplo:
```
LC_TIME=en_US.UTF-8 date
```


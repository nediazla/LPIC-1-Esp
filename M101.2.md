# 2. Instalación de Linux y Gestión de Paquetes

## 2.1 Diseño del esquema de particionado del disco duro

Tablas de particiones soportadas en Linux:
- MBR (Master Boot Record)
  - Hasta 4 particiones primarias.
  - Soportado en BIOS.
- GPT (GUID Partition Table)
  - Hasta 128 particiones.
  - Requerido para UEFI.

Herramientas de particionado:
```
lsblk
fdisk /dev/sda
parted /dev/sda
gdisk /dev/sda
```

Crear sistemas de archivos:
```
mkfs.ext4 /dev/sda1
mkfs.xfs /dev/sdb1
mkfs.btrfs /dev/sdc1
mkswap /dev/sda2
swapon /dev/sda2
```

Ver UUIDs:
```
blkid
```

Estructura típica en Ubuntu:
```
/
/home
/var
swap
/boot
/boot/efi    (para UEFI)
```

---

## 2.2 Instalación de un gestor de arranque

Ubuntu utiliza GRUB2.

Archivos importantes:
```
/boot/grub/grub.cfg
/etc/default/grub
/boot/efi/EFI/ubuntu/grubx64.efi   (UEFI)
```

Reinstalar GRUB:
```
grub-install /dev/sda
update-grub
```

Regenerar initramfs:
```
update-initramfs -u
```

Edición de opciones del kernel:
```
GRUB_CMDLINE_LINUX="quiet splash"
```

Comandos de diagnóstico:
```
journalctl -b
systemd-analyze
systemd-analyze blame
```

---

## 2.3 Gestión de librerías compartidas

Las librerías dinámicas `.so` permiten que múltiples programas compartan código.

Rutas importantes:
```
/lib
/usr/lib
/lib64
/usr/local/lib
/etc/ld.so.conf
/etc/ld.so.conf.d/
```

Ver dependencias:
```
ldd /usr/bin/ls
```

Actualizar caché de librerías:
```
ldconfig
ldconfig -p
```

Ver librerías cargadas por un proceso:
```
cat /proc/$(pidof nombre)/maps
```

---

## 2.4 Gestión de paquetes Debian (APT y dpkg)

APT trabaja a nivel alto; dpkg a nivel bajo.

Actualizar repositorios:
```
apt update
```

Actualizar paquetes:
```
apt upgrade
apt full-upgrade
```

Instalar / eliminar paquetes:
```
apt install paquete
apt remove paquete
apt purge paquete
```

Buscar paquetes:
```
apt search nginx
apt show openssl
```

Limpiar:
```
apt autoremove
apt clean
```

Instalar paquetes .deb:
```
dpkg -i archivo.deb
dpkg -l
dpkg -S /ruta/archivo
dpkg -L nombre_paquete
```

Repositorios:
```
/etc/apt/sources.list
/etc/apt/sources.list.d/
```

Simulación:
```
apt install --simulate apache2
```

---

## 2.5 Gestión de paquetes RPM y YUM/DNF

El examen exige dominar ambos tipos, aunque Ubuntu no los usa.

RPM:
```
rpm -ivh archivo.rpm
rpm -qa
rpm -ql nombre_paquete
rpm -qf /ruta/archivo
```

YUM / DNF:
```
yum install httpd
yum remove nano
dnf install nginx
dnf search openssh
dnf info paquete
dnf update
```

Bases de datos RPM:
```
/var/lib/rpm/
```

---

## 2.6 Virtualización en Linux

Tecnologías principales:
- KVM/QEMU (virtualización completa)
- LXC/LXD (contenedores)
- VirtualBox (hipervisor de tipo 2)
- VMware (tipo 1 y tipo 2)

Ver si la CPU soporta virtualización:
```
lscpu | grep Virtualization
egrep -c '(vmx|svm)' /proc/cpuinfo
```

Ver módulos cargados:
```
lsmod | grep kvm
```

Habilitar módulos:
```
modprobe kvm
modprobe kvm_intel
modprobe kvm_amd
```

Herramientas:
```
virsh
virt-install
virt-manager
```

Crear una VM (ejemplo):
```
virt-install \
  --name ubuntu-test \
  --memory 2048 \
  --vcpus 2 \
  --disk size=10 \
  --cdrom ubuntu.iso \
  --os-type linux
```

# 3. Comandos GNU y UNIX

## 3.1 Uso de la línea de comandos

Comandos básicos del CLI en Linux:

Navegación:
```
pwd
cd /ruta
cd ..
cd ~
ls
ls -l
ls -a
```

Ayuda del sistema:
```
man comando
comando --help
info comando
```

Identificación de comandos:
```
which ls
whereis bash
type cd
```

Historial:
```
history
!45
!!     # último comando
```

Autocompletado (bash + readline):
- Tab para completar.
- Ctrl + R para búsqueda inversa del historial.

---

## 3.2 Procesamiento de secuencias de texto usando filtros

Herramientas esenciales para manipular texto:

Mostrar archivos:
```
cat archivo
tac archivo
less archivo
head -n 20 archivo
tail -n 20 archivo
tail -f /var/log/syslog
```

Filtros tradicionales:
```
grep cadena archivo
grep -i cadena archivo
grep -r cadena directorio/
grep -E "expresion_regular" archivo
```

Cortar columnas:
```
cut -d: -f1 /etc/passwd
cut -d',' -f2,3 archivo.csv
```

Transformar texto:
```
tr a-z A-Z
tr -d ':' < archivo
```

Ordenar y eliminar duplicados:
```
sort archivo
sort -n archivo
uniq archivo
sort archivo | uniq
```

Contar:
```
wc archivo
wc -l archivo
wc -w archivo
```

Combinar herramientas:
```
grep "error" syslog | sort | uniq -c
```

---

## 3.3 Gestión básica de ficheros

Crear, copiar, mover, eliminar, inspeccionar archivos:

Crear:
```
touch archivo.txt
mkdir carpeta
mkdir -p dir1/dir2/dir3
```

Copiar y mover:
```
cp archivo destino
cp -r carpeta destino/
mv archivo nuevo_nombre
mv archivo /otro/directorio/
```

Eliminar:
```
rm archivo
rm -r carpeta
rm -rf carpeta    # forzado
```

Inspeccionar:
```
file archivo
stat archivo
ls -li archivo
```

Vincular:
```
ln archivo hardlink
ln -s archivo symlink
```

---

## 3.4 Uso de Streams, pipes y redirecciones

En Linux, todo es un stream:
- `stdin`  → 0
- `stdout` → 1
- `stderr` → 2

Redirecciones:
```
comando > salida.txt
comando >> salida.txt
comando 2> errores.txt
comando &> ambos.txt
```

Descartar errores:
```
comando 2>/dev/null
```

Pipes:
```
comando1 | comando2
comando1 | comando2 | comando3
```

Ejemplos:
```
ls -l | grep ".txt"
dmesg | grep -i usb | less
```

Uso avanzado:
```
grep "ssh" /var/log/auth.log | wc -l
ps aux | sort -rk 3,3 | head
```

---

## 3.5 Creación, monitorización y eliminación de procesos

Ver procesos:
```
ps
ps aux
ps -ef
top
htop
pgrep ssh
pidof nginx
```

Árbol de procesos:
```
pstree
pstree -p
```

Iniciar procesos:
```
comando &
```

Monitorizar recursos:
```
top
htop
vmstat 1
iostat 1
```

Terminar procesos:
```
kill PID
kill -9 PID        # SIGKILL
pkill nombre
killall nombre
```

Ver señales disponibles:
```
kill -l
```

---

## 3.6 Modificación de las prioridades de ejecución de procesos

Prioridades *niceness*:
- Rango: `-20` (más prioridad) a `19` (menos prioridad).
- Valores más altos = proceso más “amable”.

Ejecutar con prioridad específica:
```
nice -n 10 comando
```

Cambiar prioridad de un proceso existente:
```
renice 5 -p PID
```

Ver prioridad de procesos:
```
ps -o pid,ni,cmd -p PID
top        # columna NI
```

---

## 3.7 Búsqueda de ficheros de texto mediante expresiones regulares

Búsqueda con `grep` (regex básicas y extendidas).

Metacaracteres importantes:
```
^     inicio
$     final
.     cualquier carácter
*     repetición
[]    clases de caracteres
\     escape
```

Regex básicas:
```
grep "^root" /etc/passwd
grep "nologin$" /etc/passwd
grep "[0-9]\{3\}" archivo
```

Regex extendidas (uso de -E):
```
grep -E "error|fail" logs.txt
grep -E "([0-9]{3})" archivo
```

Buscar recursivamente:
```
grep -R "clave" /etc/
```

Mostrar número de línea:
```
grep -n cadena archivo
```

Invertir coincidencia:
```
grep -v cadena archivo
```

---

## 3.8 Operaciones de edición básica de archivos

Uso de editores estándar:

nano:
```
nano archivo
Ctrl + O   guardar
Ctrl + X   salir
```

vi/vim:
```
vi archivo
i      modo insertar
Esc    salir del modo insertar
:wq    guardar y salir
:q!    salir sin guardar
```

Edición con sed:
```
sed 's/texto/nuevo/' archivo
sed -n '5,10p' archivo
sed 's/error/ok/g' archivo
```

Procesamiento con awk:
```
awk -F: '{print $1}' /etc/passwd
awk '{print $1, $3}' archivo
```

Extracción con cut:
```
cut -d',' -f1,3 archivo.csv
```

